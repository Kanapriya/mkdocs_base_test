



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.2.0">
    
    
      
        <title>User Store Listeners - WSO2 Identity Server Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application.572ca0f0.css">
      
        <link rel="stylesheet" href="../../../assets/stylesheets/application-palette.22915126.css">
      
      
        
        
        <meta name="theme-color" content="#546e7a">
      
    
    
      <script src="../../../assets/javascripts/modernizr.8c900955.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nunito+Sans:300,400,400i,700|Courier+New">
        <style>body,input{font-family:"Nunito Sans","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Courier New","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../../extra.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="blue-grey" data-md-color-accent="deep-orange">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#user-store-listeners" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../../.." title="WSO2 Identity Server Documentation" class="md-header-nav__button md-logo">
          
            <img src="../../../images/WSO2_Software_Logo.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                WSO2 Identity Server Documentation
              </span>
              <span class="md-header-nav__topic">
                User Store Listeners
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/sherenewso2/mkdocs-base/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      View on Github
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../GettingStarted/Overview/" title="Getting Started" class="md-tabs__link">
          Getting Started
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../Concepts/Single_Sign-On_and_Identity_Federation/" title="Concepts" class="md-tabs__link">
          Concepts
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../Troubleshooting/" title="How Tos" class="md-tabs__link">
          How Tos
        </a>
      
    </li>
  

      
        
  
  
    
    
  
  
    <li class="md-tabs__item">
      
        <a href="../Writing_a_Custom_Password_Validator/" title="Develop" class="md-tabs__link md-tabs__link--active">
          Develop
        </a>
      
    </li>
  

  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../Getting_Started/" title="Admin" class="md-tabs__link">
          Admin
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../Getting_Started/" title="Deploy" class="md-tabs__link">
          Deploy
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../Getting_Started/" title="Troubleshooting" class="md-tabs__link">
          Troubleshooting
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../Getting_Started/" title="References" class="md-tabs__link">
          References
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../Getting_Started/" title="Community" class="md-tabs__link">
          Community
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <!-- Main navigation -->
<nav class="md-nav md-nav--primary" data-md-level="0">

    <!-- Site title -->
    <label class="md-nav__title md-nav__title--site" for="__drawer">
        <a href="../../.."
           title="WSO2 Identity Server Documentation" class="md-nav__button md-logo">
            
            <img src="../../../images/WSO2_Software_Logo.png" width="48" height="48" />
            
        </a>
        WSO2 Identity Server Documentation
        <label for="Versions">Ver:
            <select id="versions" onchange="window.location.href=this.value;" style="
		position: inherit;
		display: inline;
		min-width: 25%;
		/* width: 120%; */
		height: 25px;
		padding: 5px 15px 5px 5px;
		color: Black;
		border: none;
		background: transparent;
		outline: none;
		-webkit-appearance: none;
		z-index: 99;
		cursor: pointer;
		font-size: 12px;
		margin-bottom: 10px;
		border: 1px solid black;
		overflow: auto
	">
                <option value="" selected="selected">Versions</option>
 		<option value="https://Kanapriya.github.io/mkdocs-base-1/versions/IS/IS530/5.3.0/">5.3.0</option>
                <option value="https://Kanapriya.github.io/mkdocs-base-1/versions/IS/IS540/5.4.0/">5.4.0</option>
                <option value="https://Kanapriya.github.io/mkdocs-base-1/versions/IS/IS550/5.5.0/">5.5.0</option>
            </select>
        </label>
    </label>
    <!-- Repository containing source -->
    
    <div class="md-nav__source">
        


  


  <a href="https://github.com/sherenewso2/mkdocs-base/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      View on Github
    </div>
  </a>

    </div>
    

    <!-- Render item list -->
    <ul class="md-nav__list" data-md-scrollfix>
        
        
        
        


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      Getting Started
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        Getting Started
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../GettingStarted/Overview/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../GettingStarted/About_this_Release/" title="About this release" class="md-nav__link">
      About this release
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../GettingStarted/QSG/" title="Quick Start" class="md-nav__link">
      Quick Start
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
        
        
        


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Concepts
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Concepts
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Concepts/Single_Sign-On_and_Identity_Federation/" title="Single Sign-On and Identity Federation" class="md-nav__link">
      Single Sign-On and Identity Federation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Concepts/Identity_Provisioning_and_its_Standards/" title="Identity_Provisioning and its Standards" class="md-nav__link">
      Identity_Provisioning and its Standards
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Concepts/Access_Control_and_Entitlement_Management/" title="Access_Control and Entitlement Management" class="md-nav__link">
      Access_Control and Entitlement Management
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Concepts/Identity_Anti-patterns_and_the_Identity_Bus/" title="Identity Anti-patterns and the Identity Bus" class="md-nav__link">
      Identity Anti-patterns and the Identity Bus
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
        
        
        


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      How Tos
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        How Tos
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Troubleshooting/" title="Troubleshooting Guide" class="md-nav__link">
      Troubleshooting Guide
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Best Practices Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Best Practices Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../BestPracticesGuide/" title="Best Practices Guide" class="md-nav__link">
      Best Practices Guide
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Developer_Guide/" title="Testing" class="md-nav__link">
      Testing
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-3" type="checkbox" id="nav-3-3">
    
    <label class="md-nav__link" for="nav-3-3">
      Developer Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-3">
        Developer Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-3-1" type="checkbox" id="nav-3-3-1">
    
    <label class="md-nav__link" for="nav-3-3-1">
      Testing
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-3-1">
        Testing
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../WUM_Commands_Guide/" title="WUM Commands Guide" class="md-nav__link">
      WUM Commands Guide
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-3-2" type="checkbox" id="nav-3-3-2">
    
    <label class="md-nav__link" for="nav-3-3-2">
      Another subpage
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-3-2">
        Another subpage
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Developer_Guide/" title="Develop" class="md-nav__link">
      Develop
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
        
        
        

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Develop
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Develop
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-1" type="checkbox" id="nav-4-1" checked>
    
    <label class="md-nav__link" for="nav-4-1">
      User Management for Developers
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-1">
        User Management for Developers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Writing_a_Custom_Password_Validator/" title="Writing a Custom Password Validator" class="md-nav__link">
      Writing a Custom Password Validator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Writing_a_Custom_Claim_Handler/" title="Writing a Custom Claim Handler" class="md-nav__link">
      Writing a Custom Claim Handler
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        User Store Listeners
      </label>
    
    <a href="./" title="User Store Listeners" class="md-nav__link md-nav__link--active">
      User Store Listeners
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#how-listeners-work" title="How listeners work" class="md-nav__link">
    How listeners work
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interfaces" title="Interfaces" class="md-nav__link">
    Interfaces
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#attachments" title="Attachments:" class="md-nav__link">
    Attachments:
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Using_the_User_Management_Errors_Event_Listener/" title="Using the User Management Errors Event Listener" class="md-nav__link">
      Using the User Management Errors Event Listener
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Carbon_Remote_User_Store_Manager/" title="Carbon Remote User Store Manager" class="md-nav__link">
      Carbon Remote User Store Manager
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2">
    
    <label class="md-nav__link" for="nav-4-2">
      Provisioning for Developers
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-2">
        Provisioning for Developers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../provision/Writing_an_Outbound_Provisioning_Connector/" title="Writing an Outbound Provisioning Connector" class="md-nav__link">
      Writing an Outbound Provisioning Connector
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../provision/Extensible_SCIM_User_Schemas_With_WSO2_Identity_Server/" title="Extensible SCIM User Schemas With WSO2 Identity Server" class="md-nav__link">
      Extensible SCIM User Schemas With WSO2 Identity Server
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-3" type="checkbox" id="nav-4-3">
    
    <label class="md-nav__link" for="nav-4-3">
      Identity Federation for Developers
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-3">
        Identity Federation for Developers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../federate/Writing_a_Custom_Federated_Authenticator/" title="Writing a Custom Federated Authenticator" class="md-nav__link">
      Writing a Custom Federated Authenticator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../federate/Writing_a_Custom_Local_Authenticator/" title="Writing a Custom Local Authenticator" class="md-nav__link">
      Writing a Custom Local Authenticator
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
        
        
        


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Admin
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Admin
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Getting_Started/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Using_WSO2_In-Place_Updates/" title="Using WSO2 In-Place Updates" class="md-nav__link">
      Using WSO2 In-Place Updates
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
        
        
        


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Deploy
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Deploy
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Getting_Started/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Using_WSO2_In-Place_Updates/" title="Using WSO2 In-Place Updates" class="md-nav__link">
      Using WSO2 In-Place Updates
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
        
        
        


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Troubleshooting
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Troubleshooting
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Getting_Started/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Using_WSO2_In-Place_Updates/" title="Using WSO2 In-Place Updates" class="md-nav__link">
      Using WSO2 In-Place Updates
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
        
        
        


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      References
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        References
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Getting_Started/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Using_WSO2_In-Place_Updates/" title="Using WSO2 In-Place Updates" class="md-nav__link">
      Using WSO2 In-Place Updates
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
        
        
        


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      Community
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        Community
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Getting_Started/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../Using_WSO2_In-Place_Updates/" title="Using WSO2 In-Place Updates" class="md-nav__link">
      Using WSO2 In-Place Updates
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
    </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#how-listeners-work" title="How listeners work" class="md-nav__link">
    How listeners work
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interfaces" title="Interfaces" class="md-nav__link">
    Interfaces
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#attachments" title="Attachments:" class="md-nav__link">
    Attachments:
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/sherenewso2/mkdocs-base/edit/master/docs/Develop/user_mgt/User_Store_Listeners.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="user-store-listeners">User Store Listeners</h1>
<p>WSO2 Carbon User Stores provide the ability to customize user store
operations by registering an event listener for these operations. The
listeners are executed at a fixed point in the user store operation, and
the users are free to create a listener which implements their desired
logic to be executed at these fixed points. Listener is an extension to
extend the user core functions. Any number of listeners can be plugged
with the user core and they would be called one by one. By using a
listener, you are not overriding the user store implementation, which is
good since you are not customizing the existing implementations.</p>
<p>The following diagram demonstrates a typical flow of execution of the
user store operation, along with the listener's methods. The 'operation'
method (here, representative of any user store operation) first calls
the <code class="codehilite">listener.doPreOperation</code> which is implemented in the listener, then
calls the <code class="codehilite">doOperation</code>, which is implemented in the subclass extending
the <code class="codehilite">org.wso2.carbon.user.core.common.AbstractUserStoreManager</code>(the
abstract class which implements the <code class="codehilite">UserStoreManager</code> interface). After
this, the <code class="codehilite">listener.doPostOperation</code> method is called. However, this
flow will change depending on the implementation (for instance in the
carbon authorization flow, there is only one listener method that is
being called). </p>
<p><img alt="" src="attachments/92523668/92523670.png" /></p>
<h3 id="how-listeners-work">How listeners work</h3>
<p>Every time when the user core method is called, all the listeners that
are registered with that method are called. Listeners can be registered
before or after the actual method is called. Consider this example; in
the user core there is a method called <code class="codehilite">addUser()</code>. When a user is
created in WSO2 Identity Server, the <code class="codehilite">addUser()</code> method is called. You
can register a listener before the actual execution
of <code class="codehilite">addUser()</code> method and also, you can register a listener after the
actual execution of <code class="codehilite">addUser()</code> method.</p>
<p>The <code class="codehilite">addUser()</code> method can be seen as follows.</p>
<div class="codehilite"><pre><span></span><span class="n">addUser</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">preAddUser</span><span class="o">();</span> <span class="c1">// you can implement this using listener</span>
    <span class="n">actualAddUser</span><span class="o">();</span>
    <span class="n">postAddUser</span><span class="o">();</span> <span class="c1">// you can implement this using listener</span>
<span class="o">}</span>
</pre></div>

<p>Both <code class="codehilite">preAddUser()</code> and <code class="codehilite">postAddUser()</code> method can be customized as you
want. This means you can do some customizations before the user is added
or after the user is added.  **All the methods in the user core **have
been implemented as above. You can customize them both before and after.</p>
<p>Consider the following simple scenario: When a user is authenticated
with an LDAP, there is a requirement to add the authenticated time as an
attribute of the user. For this requirement, you need to write some
custom code after successful user authentication happened. The following
is the custom listener implementation for this.
The <code class="codehilite">doPostAuthenticate()</code> method would be called after actual user
authentication is done.</p>
<div class="codehilite"><pre><span></span><span class="kn">package</span> <span class="nn">org.soasecurity.user.mgt.custom.extension</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.commons.logging.Log</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.commons.logging.LogFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.wso2.carbon.user.core.UserStoreException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.wso2.carbon.user.core.UserStoreManager</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.wso2.carbon.user.core.common.AbstractUserOperationEventListener</span><span class="o">;</span>

<span class="cm">/**</span>
<span class="cm">*</span>
<span class="cm">*/</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyUserMgtCustomExtension</span> <span class="kd">extends</span> <span class="n">AbstractUserOperationEventListener</span> <span class="o">{</span>

<span class="kd">private</span> <span class="kd">static</span> <span class="n">Log</span> <span class="n">log</span> <span class="o">=</span> <span class="n">LogFactory</span><span class="o">.</span><span class="na">getLog</span><span class="o">(</span><span class="n">MyUserMgtCustomExtension</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

<span class="nd">@Override</span>
<span class="kd">public</span> <span class="kt">int</span> <span class="nf">getExecutionOrderId</span><span class="o">()</span> <span class="o">{</span>
<span class="k">return</span> <span class="mi">9883</span><span class="o">;</span>
<span class="o">}</span>
<span class="nd">@Override</span>
<span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">doPreAuthenticate</span><span class="o">(</span><span class="n">String</span> <span class="n">userName</span><span class="o">,</span> <span class="n">Object</span> <span class="n">credential</span><span class="o">,</span>
<span class="n">UserStoreManager</span> <span class="n">userStoreManager</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">UserStoreException</span> <span class="o">{</span>

<span class="c1">// just log</span>
<span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">&quot;doPreAuthenticate method is called before authenticating with user store&quot;</span><span class="o">);</span>

<span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
<span class="o">}</span>

<span class="nd">@Override</span>
<span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">doPostAuthenticate</span><span class="o">(</span><span class="n">String</span> <span class="n">userName</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">authenticated</span><span class="o">,</span> <span class="n">UserStoreManager</span> <span class="n">userStoreManager</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">UserStoreException</span> <span class="o">{</span>
<span class="c1">// just log</span>
<span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">&quot;doPreAuthenticate method is called after authenticating with user store&quot;</span><span class="o">);</span>

<span class="c1">// custom logic</span>

<span class="c1">// check whether user is authenticated</span>
<span class="k">if</span><span class="o">(</span><span class="n">authenticated</span><span class="o">){</span>

<span class="c1">// persist user attribute in to user store</span>
<span class="c1">// &quot;http://wso2.org/claims/lastlogontime&quot; is the claim uri which represent the LDAP attribute</span>
<span class="c1">// more detail about claim management from here http://soasecurity.org/2012/05/02/claim-management-with-wso2-identity-server/</span>

<span class="n">userStoreManager</span><span class="o">.</span><span class="na">setUserClaimValue</span><span class="o">(</span><span class="n">userName</span><span class="o">,</span> <span class="s">&quot;http://wso2.org/claims/lastlogontime&quot;</span><span class="o">,</span>
<span class="n">Long</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">()),</span> <span class="kc">null</span><span class="o">);</span>

<span class="o">}</span>

<span class="k">return</span> <span class="kc">true</span><span class="o">;</span>

<span class="o">}</span>

<span class="o">}</span>
</pre></div>

<p>Likewise, you can add custom extensions to any method of the user core.</p>
<p><strong>Tip</strong>: Make note of the following.</p>
<ol>
<li>The <code class="codehilite">getExecutionOrderId()</code> method can return any random value. This
    is important when there is more than one listener in the Identity
    Server and you need to consider the execution order of them</li>
<li>All the methods return a <code class="codehilite">boolean</code> value. This value is mentioned
    regardless of whether you want to execute the next listener or not.</li>
</ol>
<p>The following are the steps to configure the custom implementation.</p>
<ol>
<li>Listeners are registered as OSGI components. Therefore you need to
    register this class in an OSGI framework. You can go
    through **<a href="https://svn.wso2.org/repos/wso2/people/asela/user-mgt/custom-listener/">this</a>, **which
    is the complete sample project.</li>
<li>Copy the OSGI bundle file in to
    the <code class="codehilite">&lt;IS_HOME&gt;/repository/components/dropins</code> directory.</li>
<li>Restart the server.</li>
</ol>
<h3 id="interfaces">Interfaces</h3>
<p>In WSO2 Carbon products that use the standard user manager kernel, there
are multiple interfaces with which you can implement User Store
Listeners. </p>
<table>
<thead>
<tr>
<th>Listener Interface</th>
<th>Operation Type</th>
<th>Caller Class</th>
<th>Remarks</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://github.com/wso2/carbon-kernel/blob/4.4.x/core/org.wso2.carbon.user.core/src/main/java/org/wso2/carbon/user/core/listener/AuthorizationManagerListener.java">org.wso2.carbon.user.core.listener.AuthorizationManagerListener</a></td>
<td>doPreOperation</td>
<td><a href="https://github.com/wso2/carbon-kernel/blob/4.4.x/core/org.wso2.carbon.user.core/src/main/java/org/wso2/carbon/user/core/authorization/JDBCAuthorizationManager.java">org.wso2.carbon.user.core.authorization.JDBCAuthorizationManager</a></td>
<td>Only one listener method which gets called before each implemented operation logic</td>
</tr>
<tr>
<td><a href="https://github.com/wso2/carbon-kernel/blob/4.4.x/core/org.wso2.carbon.user.core/src/main/java/org/wso2/carbon/user/core/listener/ClaimManagerListener.java">org.wso2.carbon.user.core.listener.ClaimManagerListener</a></td>
<td>doPreOperation</td>
<td><a href="https://github.com/wso2/carbon-kernel/blob/4.4.x/core/org.wso2.carbon.user.core/src/main/java/org/wso2/carbon/user/core/claim/DefaultClaimManager.java">org.wso2.carbon.user.core.claim.DefaultClaimManager</a></td>
<td>Only one listener method which gets called before each implemented operation logic</td>
</tr>
<tr>
<td><a href="https://github.com/wso2/carbon-kernel/blob/4.4.x/core/org.wso2.carbon.user.core/src/main/java/org/wso2/carbon/user/core/listener/UserOperationEventListener.java">org.wso2.carbon.user.core.listener.UserOperationEventListener</a></td>
<td>doPreOperation and doPostOperation</td>
<td><a href="https://github.com/wso2/carbon-kernel/blob/4.4.x/core/org.wso2.carbon.user.core/src/main/java/org/wso2/carbon/user/core/common/AbstractUserStoreManager.java">org.wso2.carbon.user.core.common.AbstractUserStoreManager</a></td>
<td>pre and post operations that get called before and after (respectively) implemented operation logic</td>
</tr>
<tr>
<td><a href="https://github.com/wso2/carbon-kernel/blob/4.4.x/core/org.wso2.carbon.user.core/src/main/java/org/wso2/carbon/user/core/listener/UserStoreManagerConfigurationListener.java">org.wso2.carbon.user.core.listener.UserStoreManagerConfigurationListener</a></td>
<td>doPreOperation</td>
<td><a href="https://github.com/wso2/carbon-kernel/blob/4.4.x/core/org.wso2.carbon.user.core/src/main/java/org/wso2/carbon/user/core/common/AbstractUserStoreManager.java">org.wso2.carbon.user.core.common.AbstractUserStoreManager</a></td>
<td>One listener method which is executed before the implemented logic</td>
</tr>
<tr>
<td><a href="https://github.com/wso2/carbon-kernel/blob/4.4.x/core/org.wso2.carbon.user.core/src/main/java/org/wso2/carbon/user/core/listener/UserStoreManagerListener.java">org.wso2.carbon.user.core.listener.UserStoreManagerListener</a></td>
<td>doPreOperation</td>
<td><a href="https://github.com/wso2/carbon-kernel/blob/4.4.x/core/org.wso2.carbon.user.core/src/main/java/org/wso2/carbon/user/core/common/AbstractUserStoreManager.java">org.wso2.carbon.user.core.common.AbstractUserStoreManager</a></td>
<td>One listener method which is executed before the implemented logic</td>
</tr>
</tbody>
</table>
<p>It is recommended to extend the existing abstract implementation of
these interfaces rather than implementing from scratch. For example,
<code class="codehilite">org.wso2.carbon.user.core.listener.UserOperationEventListener</code> is
implemented in the
<code class="codehilite">org.wso2.carbon.user.core.common.AbstractUserOperationEventListener</code>
abstract class.</p>
<h2 id="attachments">Attachments:</h2>
<p><img alt="" src="images/icons/bullet_blue.gif" />{width="8" height="8"} <a href="attachments/92523668/92523670.png">image2017-3-8
12:51:43.png</a> (image/png)<br />
<img alt="" src="images/icons/bullet_blue.gif" />{width="8" height="8"} <a href="attachments/92523668/92523671.png">Untitled
drawing (1).png</a> (image/png)<br />
<img alt="" src="images/icons/bullet_blue.gif" />{width="8" height="8"} <a href="attachments/92523668/92523669.png">Untitled
drawing.png</a> (image/png)  </p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../Writing_a_Custom_Claim_Handler/" title="Writing a Custom Claim Handler" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Writing a Custom Claim Handler
              </span>
            </div>
          </a>
        
        
          <a href="../Using_the_User_Management_Errors_Event_Listener/" title="Using the User Management Errors Event Listener" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Using the User Management Errors Event Listener
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/application.b41f3d20.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../../.."}})</script>
      
    
    
      
    
  </body>
</html>